{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "title": "Financial Information with Deposit Schema",
  "required": ["lease_type", "financial_information"],
  "properties": {
    "lease_type": {
      "type": "string",
      "description": "Type of lease (must match existing lease type)",
      "enum": ["DOV", "LONG_TERM", "SHIFT", "SHORT_TERM", "MEDALLION"]
    },
    "lease_id": {
      "type": "string",
      "description": "Optional lease identifier override"
    },
    "financial_information": {
      "type": "object",
      "description": "Financial breakdown based on lease type",
      "anyOf": [
        {
          "title": "DOV Lease Financial Info",
          "required": ["lease_amount", "med_lease", "veh_lease"],
          "properties": {
            "tlc_vehicle_lifetime_cap": {"type": "number", "minimum": 0},
            "amount_collected": {"type": "number", "minimum": 0},
            "lease_amount": {"type": "number", "minimum": 0},
            "med_lease": {"type": "number", "minimum": 0},
            "med_tlc_maximum_amount": {"type": "number", "minimum": 0},
            "veh_lease": {"type": "number", "minimum": 0},
            "veh_sales_tax": {"type": "number", "minimum": 0},
            "tlc_inspection_fees": {"type": "number", "minimum": 0},
            "tax_stamps": {"type": "number", "minimum": 0},
            "registration": {"type": "number", "minimum": 0},
            "veh_tlc_maximum_amount": {"type": "number", "minimum": 0},
            "total_vehicle_lease": {"type": "number", "minimum": 0},
            "total_medallion_lease_payment": {"type": "number", "minimum": 0},
            "security_deposit": {"type": "number", "minimum": 0, "description": "Legacy field for backward compatibility"},
            "additional_balance_due": {"type": "number", "minimum": 0},
            "cancellation_charge": {"type": "number", "minimum": 0}
          }
        },
        {
          "title": "Long-Term/Shift Lease Financial Info",
          "required": ["lease_amount"],
          "properties": {
            "management_recommendation": {"type": "number", "minimum": 0},
            "day_shift": {"type": "number", "minimum": 0},
            "day_tlc_maximum_amount": {"type": "number", "minimum": 0},
            "night_shift": {"type": "number", "minimum": 0},
            "night_tlc_maximum_amount": {"type": "number", "minimum": 0},
            "lease_amount": {"type": "number", "minimum": 0},
            "security_deposit": {"type": "number", "minimum": 0, "description": "Legacy field"},
            "additional_balance_due": {"type": "number", "minimum": 0},
            "cancellation_charge": {"type": "number", "minimum": 0}
          }
        },
        {
          "title": "Short-Term Lease Financial Info",
          "properties": {
            "1_week_or_longer": {
              "type": "object",
              "properties": {
                "day_shift": {"type": "number", "minimum": 0},
                "night_shift": {"type": "number", "minimum": 0}
              }
            },
            "1_week_or_longer_tlc_maximum_amount": {
              "type": "object",
              "properties": {
                "day_shift": {"type": "number", "minimum": 0},
                "night_shift": {"type": "number", "minimum": 0}
              }
            },
            "day_of_week": {
              "type": "string",
              "enum": ["sun", "mon", "tus", "wen", "thu", "fri", "sat"]
            },
            "sun": {
              "type": "object",
              "properties": {
                "day_shift": {"type": "number", "minimum": 0},
                "night_shift": {"type": "number", "minimum": 0}
              }
            },
            "sun_tlc_maximum_amount": {
              "type": "object",
              "properties": {
                "day_shift": {"type": "number", "minimum": 0},
                "night_shift": {"type": "number", "minimum": 0}
              }
            },
            "mon": {"type": "object", "properties": {"day_shift": {"type": "number"}, "night_shift": {"type": "number"}}},
            "mon_tlc_maximum_amount": {"type": "object", "properties": {"day_shift": {"type": "number"}, "night_shift": {"type": "number"}}},
            "tus": {"type": "object", "properties": {"day_shift": {"type": "number"}, "night_shift": {"type": "number"}}},
            "tus_tlc_maximum_amount": {"type": "object", "properties": {"day_shift": {"type": "number"}, "night_shift": {"type": "number"}}},
            "wen": {"type": "object", "properties": {"day_shift": {"type": "number"}, "night_shift": {"type": "number"}}},
            "wen_tlc_maximum_amount": {"type": "object", "properties": {"day_shift": {"type": "number"}, "night_shift": {"type": "number"}}},
            "thu": {"type": "object", "properties": {"day_shift": {"type": "number"}, "night_shift": {"type": "number"}}},
            "thu_tlc_maximum_amount": {"type": "object", "properties": {"day_shift": {"type": "number"}, "night_shift": {"type": "number"}}},
            "fri": {"type": "object", "properties": {"day_shift": {"type": "number"}, "night_shift": {"type": "number"}}},
            "fri_tlc_maximum_amount": {"type": "object", "properties": {"day_shift": {"type": "number"}, "night_shift": {"type": "number"}}},
            "sat": {"type": "object", "properties": {"day_shift": {"type": "number"}, "night_shift": {"type": "number"}}},
            "sat_tlc_maximum_amount": {"type": "object", "properties": {"day_shift": {"type": "number"}, "night_shift": {"type": "number"}}},
            "security_deposit": {"type": "number", "minimum": 0},
            "additional_balance_due": {"type": "number", "minimum": 0},
            "cancellation_charge": {"type": "number", "minimum": 0}
          }
        },
        {
          "title": "Medallion-Only Lease Financial Info",
          "required": ["weekly_lease_rate"],
          "properties": {
            "weekly_lease_rate": {"type": "number", "minimum": 0},
            "week_tlc_maximum_amount": {"type": "number", "minimum": 0},
            "security_deposit": {"type": "number", "minimum": 0},
            "additional_balance_due": {"type": "number", "minimum": 0},
            "cancellation_charge": {"type": "number", "minimum": 0}
          }
        }
      ]
    },
    "deposit_info": {
      "type": "object",
      "description": "New deposit management system (optional, for new flows)",
      "properties": {
        "required_amount": {
          "type": "number",
          "description": "Required deposit amount",
          "minimum": 0
        },
        "collected_amount": {
          "type": "number",
          "description": "Amount of deposit collected",
          "minimum": 0,
          "default": 0
        },
        "collection_method": {
          "type": "string",
          "description": "Method used to collect the deposit",
          "enum": ["Cash", "Check", "ACH"]
        },
        "notes": {
          "type": "string",
          "description": "Additional notes about the deposit"
        }
      }
    }
  }
}